name: Sync Fork

on:
  schedule:
    - cron: '0 9 * * *' # 每天北京时间9:00自动更新
  workflow_dispatch: # 允许通过手动触发运行 Workflow

jobs:
  update-fork:
    runs-on: ubuntu-latest

    steps:
      # Step 1: 检出你的 fork 仓库
      - name: Checkout Repository
        uses: actions/checkout@v3
        with:
          persist-credentials: false

      # Step 2: 配置 Git 信息
      - name: Configure Git
        run: |
          git config user.name "${{ github.actor }}"
          git config user.email "${{ github.actor }}@users.noreply.github.com"

      # Step 3: 添加上游仓库地址
      - name: Add Upstream
        run: |
          git remote add upstream https://github.com/byJoey/cfnew
          git fetch upstream
          git checkout main
          git merge upstream/main

      # Step 4: 推送更新到你的 Fork 仓库
      - name: Push Updates
        run: |
          git push origin main
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
